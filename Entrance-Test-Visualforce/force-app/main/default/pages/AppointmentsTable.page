<apex:page controller="AppointmentsController">
    <style type="text/css">
    	.popup {background-color: white; border-width: 2px; border-style: solid; z-index: 9999; left: 50%; padding:11px; position: absolute; width: 600px; margin-left: -240px; top:100px;} 
    	.popupBackground {background-color:black; opacity: 0.20; filter: alpha(opacity = 20); position: absolute; width: 100%; height: 100%; top: 0; left: 0; z-index: 9998;} 
    </style>
    
    <apex:form >
    	<apex:pageBlock id="appointments_list" title="Appointments table" >
            <!-- Doctors' picklist -->
            <apex:pageBlockSection columns="1">
            	<apex:selectList id="option" value="{! selectedDocName }" label="Select a doctor" size="1" multiselect="false">
                    <apex:selectOptions value="{! selectedDoc }" />
                    <apex:actionSupport event="onchange" reRender="appointments_list" />
                </apex:selectList>
            </apex:pageBlockSection>
            
            <!-- Add New Doctor button -->
            <apex:pageBlockSection columns="1" >
            	<apex:commandButton action="{! URLFOR($Action.Doctor__c.New) }" reRender="appointments_list" value="Add New Doctor" />
            	<apex:actionSupport event="onchange" reRender="appointments_list" />
            </apex:pageBlockSection>
            
            <!-- Working Hours section -->
            <!-- <apex:pageBlockSection columns="1" >
                <apex:outputField value="{! apps.Doctor__r.Working_Hours_Start__c}" label="Working Hours Start" />
				<apex:outputField value="{! apps.Doctor__r.Working_Hours_Start__c}" label="Working Hours End" />
            </apex:pageBlockSection> -->
            
            <!-- Patients' picklist -->
            <apex:pageBlockSection columns="1" >
            	<apex:selectList id="option" value="{! selectedPatientName }" label="Select a patient" size="1" multiselect="false">
                    <apex:selectOptions value="{! selectedPatient }" />
                    <apex:actionSupport event="onchange" reRender="appointments_list" />
                </apex:selectList>
            </apex:pageBlockSection>
            
            <!-- Add New Appointment button -->
            <apex:pageBlockSection columns="1" >
            	<apex:commandButton action="{! URLFOR($Action.Appointment__c.New) }" reRender="appointments_list" value="Add New Appointment" />
            </apex:pageBlockSection>
            
            <!-- Table -->
        	<apex:pageBlockTable value="{! apps }" var="app"> 
                <!-- Action column -->
                <apex:column headerValue="Action">
                    <apex:outputLink value="/{!app.Id}">View</apex:outputLink>
                </apex:column>
                
                <!-- Doctor's Name column -->
                <apex:column value="{! app.Doctor__r.Name }">
                	<apex:facet name="header">
                        <apex:commandLink action="{! sortOrder }" reRender="appointments_list" value="Doctor's Name">
                        	<apex:param value="Doctor__r.Name" assignTo="{! sortByField }"></apex:param>
                        </apex:commandLink>
                    </apex:facet>
                </apex:column>
                
                <!-- Patient column -->
                <apex:column value="{! app.Patient__r.Name }">
                	<apex:facet name="header">
                        <apex:commandLink action="{! sortOrder }" reRender="appointments_list" value="Patient's Name">
                        	<apex:param value="Patient__r.Name" assignTo="{! sortByField }"></apex:param>
                        </apex:commandLink>
                    </apex:facet>
                </apex:column>
                
                <!-- Date column -->
                <apex:column value="{! app.Appointment_Date__c }">
                	<apex:facet name="header">
                        <apex:commandLink action="{! sortOrder }" reRender="appointments_list" value="Date">
                        	<apex:param value="Appointment_Date__c" assignTo="{! sortByField }"></apex:param>
                        </apex:commandLink>
                    </apex:facet>
                </apex:column>
                
                <!-- Duration column -->
                <apex:column value="{! app.Duration_in_minutes__c } minutes">
                	<apex:facet name="header">
                        <apex:commandLink action="{! sortOrder }" reRender="appointments_list" value="Duration">
                        	<apex:param value="Duration_in_minutes__c" assignTo="{! sortByField }"></apex:param>
                        </apex:commandLink>
                    </apex:facet>
                </apex:column>
            </apex:pageBlockTable>
        </apex:pageBlock>
    </apex:form>
</apex:page>